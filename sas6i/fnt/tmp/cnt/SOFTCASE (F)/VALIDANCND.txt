SELECT *
FROM COMPRAS_NC_ND_SRI
WHERE (IVA_PERIODO,IDENTIFICACION_PRV,CODIGO_TIPO_COMPROBANTE,
SERIE_COMPROBANTE,SECUENCIA_COMPROBANTE) IN (
SELECT IVA_PERIODO,IDENTIFICACION_PRV,CODIGO_TIPO_COMPROBANTE,
SERIE_COMPROBANTE,SECUENCIA_COMPROBANTE
FROM COMPRAS_NC_ND_SRI
GROUP BY IVA_PERIODO,IDENTIFICACION_PRV,CODIGO_TIPO_COMPROBANTE,
SERIE_COMPROBANTE,SECUENCIA_COMPROBANTE
HAVING COUNT(*)>1)
/

ALTER TABLE "SIS"."COMPRAS_NC_ND_SRI"
    ADD(CONSTRAINT "CMPNCNDSRISERFCT" UNIQUE("IDENTIFICACION_PRV",
    "SERIE_COMPROBANTE", "SECUENCIA_COMPROBANTE", "IVA_PERIODO","CODIGO_TIPO_COMPROBANTE"))
/
