SELECT
RTRIM(EMPROL.APELLIDOS)||' '||RTRIM(EMPROL.NOMBRES)
EMPLEADO,
CRGEMP.DESCRIPCION CARGO,
EMPROL.TERCERIZADORA BANCO,
EMPROL.CEDULA,
EMPROL.FECHA_DE_INGRESO FECHA_DE_INGRESO,
EMPROL.CODIGO EMPROL_CODIGO2,
PRMMVM.ALIAS ALIAS,
ROUND(PRMMVM.VALOR,2) VALOR
FROM
CARGOS_EMPLEADOS CRGEMP,
EMPLEADOS_ROLES EMPROL,
PARAMETROS_MOVIMIENTOS PRMMVM
WHERE
--( PRMMVM.SECUENCIA_EN_ROL > 0 AND (PRMMVM.VALOR > 0 OR PRMMVM.IMPRIMIR_CERO = 'V'))  AND
'CSI' = PRMMVM.ROLPGS_EMP_CODIGO AND
&NUMROL = PRMMVM.ROLPGS_NUMERO AND
EMPROL.EMP_CODIGO = 'CSI'  AND
PRMMVM.EMPROL_EMP_CODIGO = EMPROL.EMP_CODIGO AND
PRMMVM.EMPROL_CODIGO = EMPROL.CODIGO AND
'CSI' = PRMMVM.ROLPGS_EMP_CODIGO AND
&NUMROL = PRMMVM.ROLPGS_NUMERO AND
EMPROL.CRGEMP_CODIGO = CRGEMP.CODIGO AND
EMPROL.CRGEMP_EMP_CODIGO = CRGEMP.EMP_CODIGO AND
'CSI'= PRMMVM.ROLPGS_EMP_CODIGO AND
&NUMROL= PRMMVM.ROLPGS_NUMERO
--ORDER BY PRMMVM.SECUENCIA_EN_ROL,PRMMVM.ALIAS,RTRIM(EMPROL.APELLIDOS)||' '||RTRIM(EMPROL.NOMBRES)
UNION -- SOBRESUELDOS
SELECT RTRIM(E.APELLIDOS)||' '||RTRIM(E.NOMBRES) EMPLEADO,
E.TERCERIZADORA BANCO,
CRGEMP.DESCRIPCION CARGO,
E.CEDULA,
E.FECHA_DE_INGRESO FECHA_DE_INGRESO,E.CODIGO,'SOBRESUELDOS',
ROUND(VALOR,2)
FROM MOVIMIENTOS_ROLES M,EMPLEADOS_ROLES E,CARGOS_EMPLEADOS CRGEMP
WHERE PRMROL_CODIGO='P0137'
AND EMPROL_EMP_CODIGO='CSI'
AND ROLPGS_NUMERO=&NUMROL
AND ESTADO!='A'
AND EMPROL_EMP_CODIGO=E.EMP_CODIGO
AND EMPROL_CODIGO=E.CODIGO
AND E.CRGEMP_CODIGO = CRGEMP.CODIGO
AND E.CRGEMP_EMP_CODIGO = CRGEMP.EMP_CODIGO
-- SOBRESUELDOS

SELECT E.CODIGO,RTRIM(E.APELLIDOS)||' '||RTRIM(E.NOMBRES) EMPLEADO,
CRGEMP.DESCRIPCION CARGO,
E.FECHA_DE_INGRESO FECHA_DE_INGRESO,
ROUND(VALOR,2)
FROM MOVIMIENTOS_ROLES M,EMPLEADOS_ROLES E,CARGOS_EMPLEADOS CRGEMP
WHERE PRMROL_CODIGO='P0137'
AND EMPROL_EMP_CODIGO='CSI'
AND ROLPGS_NUMERO=:NUMROL
AND ESTADO!='A'
AND EMPROL_EMP_CODIGO=E.EMP_CODIGO
AND EMPROL_CODIGO=E.CODIGO          
AND E.CRGEMP_CODIGO = CRGEMP.CODIGO
AND E.CRGEMP_EMP_CODIGO = CRGEMP.EMP_CODIGO
/

