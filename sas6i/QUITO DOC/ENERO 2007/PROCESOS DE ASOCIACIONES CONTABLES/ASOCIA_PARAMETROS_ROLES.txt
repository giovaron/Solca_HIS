BEGIN
DECLARE CURSOR PATRON IS
    SELECT * FROM CUENTAS_ASOCIADAS 
    WHERE EMP_CODIGO = 'CSI' AND 
          CLAVE_RELACIONADA = 'P0024' AND 
          TIPO_DE_CUENTA='RDP' AND 
          TIPO_DE_ASOCIACION='GRP';
CURSOR PARAMETROS IS 
SELECT CODIGO FROM PARAMETROS_ROLES
WHERE PARAMETROS_ROLES.EMP_CODIGO = 'CSI' AND
PARAMETROS_ROLES.TIPO <> 'B' AND
-- PARAMETROS_ROLES.TIPO_MOVIMIENTO ='D' AND
PARAMETROS_ROLES.ESTADO_DE_DISPONIBILIDAD = 'D' AND
PARAMETROS_ROLES.PROPIETARIO IN ('E','P') AND
PARAMETROS_ROLES.TIPO_CONTABILIZACION = 'G' AND
--PROVISION = 'F' AND 
CODIGO BETWEEN 'P0364' AND 'P0364' -- ============== CAMBIAR EL CODIGO QUE SE QUIERE ASOCIAR ================
ORDER BY CODIGO;
BEGIN
    DBMS_OUTPUT.PUT_LINE('ASOCIANDO PARAMETROS');
FOR RPARAMETROS IN PARAMETROS LOOP
    DBMS_OUTPUT.PUT_LINE('ASOCIANDO PARAMETROS DE '||RPARAMETROS.CODIGO);
   FOR RPATRON IN PATRON LOOP
/*      IF RPARAMETROS.CODIGO = 'P0026' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'09','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN('P0032','P0033','P0034') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'21','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO = 'P0039' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'24','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0040' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'02','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0059' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'25','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO ='P0071' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'28','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO = 'P0072' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'29','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0095' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'04','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0096' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'05','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0097' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'26','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO = 'P0121' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'03','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN('P0123') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'08','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO = 'P0127' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'10','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0129' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'14','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO); 
      ELSIF RPARAMETROS.CODIGO = 'P0132' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'16','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO ='P0133' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'06','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO = 'P0135' THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'12','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);   
      IF RPARAMETROS.CODIGO IN ('P0205','P0206','P0207','P0208') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'07','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);   
      ELSIF RPARAMETROS.CODIGO IN ('P0209') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'17','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      IF RPARAMETROS.CODIGO IN ('P0048') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'23','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN ('P0054') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'32','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN ('P0128') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,7)||'02'||'0105','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN ('P0150') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'24','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN ('P0152','P0153') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'18','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      ELSIF RPARAMETROS.CODIGO IN ('P0259') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'15','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      IF RPARAMETROS.CODIGO IN ('P0354') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'11','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      IF RPARAMETROS.CODIGO IN ('P0357') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,7)||'05'||SUBSTR(RPATRON.CUENTA,10,2)||'05','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      IF RPARAMETROS.CODIGO IN ('P0502') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'25','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0450') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'01','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0451') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'02','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0452') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'03','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0453') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'09','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0454') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'08','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0455') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'10','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0456') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'14','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0457') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'06','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0458') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'12','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0459') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'15','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
      IF RPARAMETROS.CODIGO IN ('P0460') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,11)||'11','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       */
      IF RPARAMETROS.CODIGO IN ('P0364') THEN
         INSERT INTO CUENTAS_ASOCIADAS(CNTASC_ID,TIPO_DE_CUENTA,TIPO_DE_ASOCIACION,
                                      CLAVE_RELACIONADA,CUENTA,EMP_CODIGO,OBSERVACION,
                                      AGRCNT_TIPO,AGRCNT_CODIGO)
         VALUES(CNTASC_SEQ.NEXTVAL,RPATRON.TIPO_DE_CUENTA,RPATRON.TIPO_DE_ASOCIACION,
                RPARAMETROS.CODIGO,SUBSTR(RPATRON.CUENTA,1,7)||'02'||SUBSTR(RPATRON.CUENTA,10,2)||'05','CSI',NULL,
                RPATRON.AGRCNT_TIPO,RPATRON.AGRCNT_CODIGO);
      END IF;       
   END LOOP;
END LOOP;
-- CORRIGE CUENTAS
    DBMS_OUTPUT.PUT_LINE('CORRIGIENDO CUENTAS');
BEGIN
DECLARE
CURSOR cCrr IS
SELECT /*+ RULE */ DISTINCT CLAVE_RELACIONADA,CUENTA, 
DECODE(SUBSTR(CUENTA,1,5),
'50101',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
'50102',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
'50104',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
'50107',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
SUBSTR(CNTASC.CUENTA,1,5)||SUBSTR(CNTASC.CUENTA,8,6)) NVA_CTA
--,CLAVE_RELACIONADA
FROM CUENTAS_ASOCIADAS CNTASC ,PLAN_DE_CUENTAS PLNCNT
WHERE ( (CNTASC.EMP_CODIGO = 'CSI' AND
-- CNTASC.CLAVE_RELACIONADA = 'P0123' AND
CNTASC.TIPO_DE_CUENTA='RDP' AND
CNTASC.TIPO_DE_ASOCIACION='GRP') )
AND PLNCNT.CODIGO(+)=CNTASC.CUENTA
AND PLNCNT.CODIGO IS NULL
AND SUBSTR(CUENTA,1,3)='501'
UNION
SELECT /*+ RULE */ DISTINCT CLAVE_RELACIONADA,CUENTA,
SUBSTR(CNTASC.CUENTA,1,5)||SUBSTR(CNTASC.CUENTA,8,2)
||SUBSTR(CNTASC.CUENTA,6,2)||SUBSTR(CNTASC.CUENTA,10,4)
--,CLAVE_RELACIONADA
FROM CUENTAS_ASOCIADAS CNTASC ,PLAN_DE_CUENTAS PLNCNT
WHERE ( (CNTASC.EMP_CODIGO = 'CSI' AND
-- CNTASC.CLAVE_RELACIONADA = 'P0123' AND
CNTASC.TIPO_DE_CUENTA='RDP' AND
CNTASC.TIPO_DE_ASOCIACION='GRP') )
AND PLNCNT.CODIGO(+)=CNTASC.CUENTA
AND PLNCNT.CODIGO IS NULL
AND SUBSTR(CUENTA,1,3)='502';
BEGIN
  FOR rCrr in CCrr LOOP
    update cuentas_asociadas CNTASC
    set cuenta=rCrr.NVA_CTA
    WHERE CNTASC.TIPO_DE_CUENTA='RDP' AND
          CNTASC.TIPO_DE_ASOCIACION='GRP' AND
          CNTASC.CUENTA=rCrr.cuenta AND
          CNTASC.CLAVE_RELACIONADA=rCrr.CLAVE_RELACIONADA;
--    DBMS_OUTPUT.PUT_LINE(rCrr.CLAVE_RELACIONADA||' ANTIGUA '||rCrr.CUENTA||' NUEVA '||rCrr.NVA_CTA||' '||SQL%ROWCOUNT);
  END LOOP;
END;
END;
-- Asociamos las cuentas individuales
    DBMS_OUTPUT.PUT_LINE('ASOCIANDO CUENTAS INDIVIDUALES NO ASOCIADAS');
BEGIN
DECLARE
CURSOR cAscEmp IS
SELECT EMPROL.EMP_CODIGO,EMPROL.CODIGO
FROM  EMPLEADOS_CUENTAS_INDIVIDUALES EMPCNTIND,
EMPLEADOS_ROLES EMPROL
WHERE EMPCNTIND.EMPROL_EMP_CODIGO(+)=EMPROL.EMP_CODIGO
AND EMPCNTIND.EMPROL_CODIGO(+)=EMPROL.CODIGO
AND EMPCNTIND.EMPROL_CODIGO IS NULL;
BEGIN
  FOR rAscEmp IN cAscEmp LOOP
    INSERT INTO EMPLEADOS_CUENTAS_INDIVIDUALES
    SELECT rAscEmp.EMP_CODIGO,
              rAscEmp.CODIGO,CUENTA_CONTABLE,TERCERIZADORA
       FROM EMPLEADOS_CUENTAS_INDIVIDUALES
       WHERE EMPROL_EMP_CODIGO=rAscEmp.EMP_CODIGO AND EMPROL_CODIGO=21;
  END LOOP;
END;
END;
END;
END;
/





P0048 VALOR POR VELADAS HORAS
P0054 VALOR POR GUARDIA MEDICA
P0128 TRANSPORTE
P0147 RETROACTIVO
P0150 APORTE I.E.E.S POR HORAS
P0152 PROPORCIONAL XIII
P0153 PROPORCIONAL XIIV
TRIBUNAL DE MENORES


SELECT CNTASC.CUENTA
FROM CUENTAS_ASOCIADAS CNTASC ,PLAN_DE_CUENTAS PLNCNT
WHERE ( (CNTASC.EMP_CODIGO = 'CSI' AND
-- CNTASC.CLAVE_RELACIONADA = 'P0123' AND
CNTASC.TIPO_DE_CUENTA='RDP' AND
CNTASC.TIPO_DE_ASOCIACION='GRP') )
AND PLNCNT.CODIGO(+)=CNTASC.CUENTA
AND PLNCNT.CODIGO IS NULL



SELECT CODIGO,NOMBRE
FROM PLAN_DE_CUENTAS
WHERE CODIGO IN (
SELECT /*+ RULE */ DISTINCT 
DECODE(SUBSTR(CUENTA,1,5),
'50101',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
'50102',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
'50104',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
'50107',SUBSTR(CNTASC.CUENTA,1,9)||SUBSTR(CNTASC.CUENTA,12,2),
SUBSTR(CNTASC.CUENTA,1,5)||SUBSTR(CNTASC.CUENTA,8,6))
--,CLAVE_RELACIONADA
FROM CUENTAS_ASOCIADAS CNTASC ,PLAN_DE_CUENTAS PLNCNT
WHERE ( (CNTASC.EMP_CODIGO = 'CSI' AND
-- CNTASC.CLAVE_RELACIONADA = 'P0123' AND
CNTASC.TIPO_DE_CUENTA='RDP' AND
CNTASC.TIPO_DE_ASOCIACION='GRP') )
AND PLNCNT.CODIGO(+)=CNTASC.CUENTA
AND PLNCNT.CODIGO IS NULL
AND SUBSTR(CUENTA,1,3)='501'
UNION
SELECT /*+ RULE */ DISTINCT 
SUBSTR(CNTASC.CUENTA,1,5)||SUBSTR(CNTASC.CUENTA,8,2)
||SUBSTR(CNTASC.CUENTA,6,2)||SUBSTR(CNTASC.CUENTA,10,4)
--,CLAVE_RELACIONADA
FROM CUENTAS_ASOCIADAS CNTASC ,PLAN_DE_CUENTAS PLNCNT
WHERE ( (CNTASC.EMP_CODIGO = 'CSI' AND
-- CNTASC.CLAVE_RELACIONADA = 'P0123' AND
CNTASC.TIPO_DE_CUENTA='RDP' AND
CNTASC.TIPO_DE_ASOCIACION='GRP') )
AND PLNCNT.CODIGO(+)=CNTASC.CUENTA
AND PLNCNT.CODIGO IS NULL
AND SUBSTR(CUENTA,1,3)='502')
/


