SELECT
KRDFCT.CLNPGA_APELLIDOS||' '||KRDFCT.CLNPGA_NOMBRES CLIENTE_PAGA,
TO_CHAR(KRDFCT.FECHA,'DD/MM/YYYY HH24:MI') FECHA,
SUM(ROUND(KRDFCT.HABER,2)) VALOR 
FROM
KARDEX_FACTURACION KRDFCT
WHERE
/* Solo vemos los pagos en esas fechas sin importar la KRDFCT.ctacbr_fecha*/
('COTCNC'='COTCNC' AND  KRDFCT.FECHA BETWEEN TO_dATE('01/JUL/2006 00:00','DD/MM/YYYY HH24:MI') AND
                                             TO_dATE('02/JUL/2006 23:59','DD/MM/YYYY HH24:MI') AND
KRDFCT.DEBE=0)
/*Aqui filtramos KRDFCT.clasificacion paciente y el modo de pago */
AND (TIPO_PAGO!='DDA' AND TO_CHAR(KRDFCT.MDOPGO_NUMERO) ='7'OR KRDFCT.TIPO_PAGO='DDA') AND
     KRDFCT.CLASIFICACION LIKE'%' AND
     TO_CHAR(KRDFCT.MDOPGO_NUMERO) LIKE '7' AND
PAGO_CAJA = 'CJT'
GROUP BY KRDFCT.CLNPGA_APELLIDOS||' '||KRDFCT.CLNPGA_NOMBRES,
KRDFCT.FECHA
ORDER BY 1
/
