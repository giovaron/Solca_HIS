CREATE TABLE RESTRICCIONES_SMS
AS SELECT OWNER        ,
CONSTRAINT_NAME        ,
CONSTRAINT_TYPE        ,
TABLE_NAME             ,
R_OWNER                ,
R_CONSTRAINT_NAME      ,
DELETE_RULE            ,
STATUS                 ,
DEFERRABLE             ,
DEFERRED               ,
VALIDATED              ,
GENERATED              ,
BAD                    ,
RELY                   ,
LAST_CHANGE
FROM USER_CONSTRAINTS
/

SELECT C2.*
FROM RESTRICCIONES_SMS@SOLCA C1,USER_CONSTRAINTS C2
WHERE C1.TABLE_NAME(+)=C2.TABLE_NAME
AND C2.CONSTRAINT_TYPE IN ('P','R')
AND C2.CONSTRAINT_NAME=C1.CONSTRAINT_NAME (+)
AND C1.OWNER IS NULL
and c2.table_NAME NOT LIKE 'SM%'
ORDER BY C2.TABLE_NAME
/
