CREATE OR REPLACE VIEW "SMS"."INGRESOS_AFJ" ("DESCRIPCION",
    "EMP_CODIGO","MYR_CODIGO","CNT_CODIGO","SCNT_CODIGO",
    "AXL_CODIGO","SAXL_CODIGO","SAXL2_CODIGO","SAXL3_CODIGO",
    "NUMERO","VALOR") AS 
    SELECT 'BIENES ADQUIRIDOS',CNTASC.EMP_CODIGO, 
PLNCNT.MYR_CODIGO, PLNCNT.CNT_CODIGO , 
PLNCNT.SCNT_CODIGO , PLNCNT.AXL_CODIGO , 
PLNCNT.SAXL_CODIGO , PLNCNT.SAXL2_CODIGO , 
PLNCNT.SAXL3_CODIGO , 
MVMACTFJO.MVM_NUMERO, 
SUM(MVMACTFJO.DEBE) 
FROM MOVIMIENTOS_ACTIVOS_FIJOS  MVMACTFJO, 
            CUENTAS_ASOCIADAS CNTASC, 
            PLAN_DE_CUENTAS PLNCNT, 
            ACTIVOS_FIJOS_ESPECIFICOS AFJESP 
WHERE MVMACTFJO.SBGACTFJO_GRPACTFJO_EMP_CODIGO = CNTASC.EMP_CODIGO AND 
      TO_CHAR(MVMACTFJO.ACTFSBGACTFJO_GRPACTFJO_CODIGO) = CNTASC.CLAVE_RELACIONADA AND 
      MVMACTFJO.MVM_TIPO LIKE 'ING%' AND 
      MVMACTFJO.ESTADO = 'N' AND 
      CNTASC.TIPO_DE_CUENTA = 'AFJ'  AND 
      CNTASC.TIPO_DE_ASOCIACION = 'CAF'  AND 
      CNTASC.EMP_CODIGO = PLNCNT.EMP_CODIGO AND 
      CNTASC.CUENTA=PLNCNT.CODIGO AND 
      MVMACTFJO.DEBE > 0 AND 
      MVMACTFJO.SBGACTFJO_GRPACTFJO_EMP_CODIGO = AFJESP.SBGACTFJO_GRPACTFJO_EMP_CODIGO AND 
      MVMACTFJO.ACTFSBGACTFJO_GRPACTFJO_CODIGO = AFJESP.ACTFSBGACTFJO_GRPACTFJO_CODIGO AND 
      MVMACTFJO.ACTFACTFJOGNR_SBGACTFJO_CODIGO = AFJESP.ACTFJOGNR_SBGACTFJO_CODIGO AND 
      MVMACTFJO.ACTFJOESP_ACTFJOGNR_CODIGO           = AFJESP.ACTFJOGNR_CODIGO AND 
      MVMACTFJO.ACTFJOESP_CODIGO                                    =  AFJESP.CODIGO AND 
     AFJESP.TIPO = 'A' 
GROUP BY CNTASC.EMP_CODIGO, PLNCNT.MYR_CODIGO, 
                    PLNCNT.CNT_CODIGO ,  PLNCNT.SCNT_CODIGO , 
                    PLNCNT.AXL_CODIGO , PLNCNT.SAXL_CODIGO , 
                    PLNCNT.SAXL2_CODIGO , PLNCNT.SAXL3_CODIGO , 
                    MVMACTFJO.MVM_NUMERO 
UNION 
SELECT 'BIENES ADQUIRIDOS',PRMINT.EMP_CODIGO, 
PLNCNT.MYR_CODIGO, PLNCNT.CNT_CODIGO , 
PLNCNT.SCNT_CODIGO , PLNCNT.AXL_CODIGO , 
PLNCNT.SAXL_CODIGO , PLNCNT.SAXL2_CODIGO , 
PLNCNT.SAXL3_CODIGO , 
MVMACTFJO.MVM_NUMERO, 
SUM(MVMACTFJO.DEBE) 
FROM MOVIMIENTOS_ACTIVOS_FIJOS  MVMACTFJO, 
            PARAMETROS_INTEGRACION PRMINT, 
            PLAN_DE_CUENTAS PLNCNT, 
            ACTIVOS_FIJOS_ESPECIFICOS AFJESP 
WHERE  MVMACTFJO.MVM_TIPO LIKE 'ING%' AND 
      MVMACTFJO.ESTADO = 'N' AND 
      PRMINT.TIPO = 'AFJ'  AND 
      PRMINT.PARAMETRO = 'SMNCNT'  AND 
      PRMINT.EMP_CODIGO = PLNCNT.EMP_CODIGO AND 
      PRMINT.CUENTA_CONTABLE=PLNCNT.CODIGO AND 
      MVMACTFJO.DEBE > 0 AND 
            MVMACTFJO.SBGACTFJO_GRPACTFJO_EMP_CODIGO = AFJESP.SBGACTFJO_GRPACTFJO_EMP_CODIGO AND 
      MVMACTFJO.ACTFSBGACTFJO_GRPACTFJO_CODIGO = AFJESP.ACTFSBGACTFJO_GRPACTFJO_CODIGO AND 
      MVMACTFJO.ACTFACTFJOGNR_SBGACTFJO_CODIGO = AFJESP.ACTFJOGNR_SBGACTFJO_CODIGO AND 
      MVMACTFJO.ACTFJOESP_ACTFJOGNR_CODIGO           = AFJESP.ACTFJOGNR_CODIGO AND 
      MVMACTFJO.ACTFJOESP_CODIGO                                    =  AFJESP.CODIGO AND 
     AFJESP.TIPO = 'S' 
GROUP BY PRMINT.EMP_CODIGO, PLNCNT.MYR_CODIGO, 
                    PLNCNT.CNT_CODIGO ,  PLNCNT.SCNT_CODIGO , 
                    PLNCNT.AXL_CODIGO , PLNCNT.SAXL_CODIGO , 
                    PLNCNT.SAXL2_CODIGO , PLNCNT.SAXL3_CODIGO , 
                    MVMACTFJO.MVM_NUMERO 
UNION 
SELECT 'I.V.A',PLNCNT.EMP_CODIGO, 
PLNCNT.MYR_CODIGO, PLNCNT.CNT_CODIGO , 
PLNCNT.SCNT_CODIGO , PLNCNT.AXL_CODIGO , 
PLNCNT.SAXL_CODIGO , PLNCNT.SAXL2_CODIGO , 
PLNCNT.SAXL3_CODIGO , 
DTLINGACT.INGACTFJO_NUMERO, 
SUM(DTLINGACT.IVA_CALCULADO) 
FROM DETALLES_INGRESOS_ACTIVOS  DTLINGACT, 
            PLAN_DE_CUENTAS PLNCNT 
WHERE  PLNCNT.TIPO_DE_CUENTA = 'IVA' AND 
       DTLINGACT.INGACTFJO_EMP_CODIGO = PLNCNT.EMP_CODIGO AND 
       DTLINGACT.ESTADO = 'N' AND 
       DTLINGACT.IVA_CALCULADO > 0 
GROUP BY PLNCNT.EMP_CODIGO, PLNCNT.MYR_CODIGO, 
                    PLNCNT.CNT_CODIGO ,  PLNCNT.SCNT_CODIGO , 
                    PLNCNT.AXL_CODIGO , PLNCNT.SAXL_CODIGO , 
                    PLNCNT.SAXL2_CODIGO , PLNCNT.SAXL3_CODIGO , 
                    DTLINGACT.INGACTFJO_NUMERO
GROUP BY PLNCNT.EMP_CODIGO, PLNCNT.MYR_CODIGO,
                    PLNCNT.CNT_CODIGO ,  PLNCNT.SCNT_CODIGO ,
                    PLNCNT.AXL_CODIGO , PLNCNT.SAXL_CODIGO ,
                    PLNCNT.SAXL2_CODIGO , PLNCNT.SAXL3_CODIGO ,
                    DTLINGACT.INGACTFJO_NUMERO