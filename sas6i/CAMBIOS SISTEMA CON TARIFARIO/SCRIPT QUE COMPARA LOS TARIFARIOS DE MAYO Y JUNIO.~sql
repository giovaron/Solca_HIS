BEGIN
DECLARE CURSOR CONVENIO
IS SELECT * FROM NVOTARIFARIO N ORDER BY N.CODIGO;
ITEM VARCHAR2(4000);
BEGIN
   FOR RCONVENIO IN CONVENIO LOOP
      BEGIN
      SELECT T.CODIGO_ITEM INTO ITEM
      FROM TARIFARIOS T
      WHERE T.CODIGO_ITEM = RCONVENIO.CODIGO AND
            UPPER(T.DESCRIPCION_ITEM) = UPPER(RCONVENIO.DESCRIPCION);
      EXCEPTION
      WHEN NO_DATA_FOUND THEN
         INSERT INTO NVOTARIFARIO_NO_EXISTE
         VALUES(RCONVENIO.CODIGO,UPPER(RCONVENIO.DESCRIPCION),RCONVENIO.UVR,
                RCONVENIO.NIVELI,RCONVENIO.NIVELII,RCONVENIO.NIVELIII,
                RCONVENIO.UVRHMED,RCONVENIO.UVRANES);
      END;   
   END LOOP;
END;
END;
