BEGIN
DECLARE CURSOR CONVENIO
IS SELECT * FROM NVOTARIFARIO N ORDER BY N.CODIGO;
BEGIN
   FOR RCONVENIO IN CONVENIO LOOP
      BEGIN
      UPDATE TARIFARIOS T
      SET T.UVR_H_MED = TO_NUMBER(REPLACE(RCONVENIO.UVRHMED,',','.')),
          T.UVR =  TO_NUMBER(REPLACE(RCONVENIO.UVR,',','.')),
          T.ANES = TO_NUMBER(REPLACE(RCONVENIO.UVRANES,',','.')),
          T.UVR1 = TO_NUMBER(REPLACE(RCONVENIO.NIVELI,',','.')),
          T.UVR2 = TO_NUMBER(REPLACE(RCONVENIO.NIVELII,',','.')),
          T.UVR3 = TO_NUMBER(REPLACE(RCONVENIO.NIVELIII,',','.'))
      WHERE T.CODIGO_ITEM = RCONVENIO.CODIGO AND
            UPPER(T.DESCRIPCION_ITEM) = UPPER(RCONVENIO.DESCRIPCION);
      EXCEPTION
      WHEN OTHERS THEN         
      BEGIN
         INSERT INTO NVOTARIFARIO_NO_EXISTE
         VALUES(RCONVENIO.CODIGO,UPPER(RCONVENIO.DESCRIPCION),RCONVENIO.UVR,
                RCONVENIO.NIVELI,RCONVENIO.NIVELII,RCONVENIO.NIVELIII,
                RCONVENIO.UVRHMED,RCONVENIO.UVRANES);
      END;   
      END;      
   END LOOP;
END;
END;
